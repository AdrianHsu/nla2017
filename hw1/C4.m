% graph.txt
% A = [3 -1 -1 -1; -1 2 -1 0; -1 -1 3 -1; -1 0 -1 2];
% A = [7 4 1; 4 4 4; 1 4 7];
% A = [1 2; 2 1];

A = [-4 14 0; -5 13 0; -1 0 2];
x = [1 1 1]';
tol = 1e-8;
N = 100;
n = length(x);

B1 = A;
[r1, u1] = pm(A, x, tol, N);

x1 = B1(1,1:n)'/(r1*u1(1));
v1 = x1;
B2 = B1-r1*u1*x1';

[r2, u2] = pm(B2, x, tol, N);

x2=B2(2,1:n)'/(r2*u2(2));
v2=(r2-r1)*u2+r1*(x1'*u2)*u1;
B3=B2-r2*u2*x2';

[r3, u3] = pm(B3, x, tol, N);

v3 = (r3-r2)*u3+r2*(x2'*u3)*u2;

ans = [v1 v2 v3];

